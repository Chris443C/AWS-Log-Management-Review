{
  "metadata": {
    "generated_at": "2025-06-18T20:41:04.135362",
    "tool_version": "1.0.0",
    "pci_dss_version": "v4.0.1"
  },
  "summary": {
    "total_issues": 12,
    "total_recommendations": 7,
    "compliance_score": 46,
    "estimated_monthly_cost": "$82"
  },
  "findings": {
    "cloudtrail": {
      "enabled": false,
      "multi_region": false,
      "log_file_validation": false,
      "s3_bucket": null,
      "issues": [
        {
          "severity": "HIGH",
          "description": "No CloudTrail trails found",
          "pci_reference": "10.2.1-10.2.7",
          "recommendation": "Enable CloudTrail for API activity logging"
        }
      ]
    },
    "s3_logging": {
      "buckets_analyzed": 5,
      "buckets_with_logging": 2,
      "buckets_without_logging": [
        "bucket1",
        "bucket2",
        "bucket3"
      ],
      "issues": [
        {
          "severity": "MEDIUM",
          "description": "S3 bucket bucket1 does not have access logging enabled",
          "pci_reference": "10.2.1",
          "recommendation": "Enable access logging for bucket bucket1"
        },
        {
          "severity": "MEDIUM",
          "description": "S3 bucket bucket2 does not have access logging enabled",
          "pci_reference": "10.2.1",
          "recommendation": "Enable access logging for bucket bucket2"
        },
        {
          "severity": "MEDIUM",
          "description": "S3 bucket bucket3 does not have access logging enabled",
          "pci_reference": "10.2.1",
          "recommendation": "Enable access logging for bucket bucket3"
        }
      ]
    },
    "cloudwatch_logs": {
      "log_groups": 8,
      "log_groups_with_retention": 3,
      "log_groups_without_retention": [
        "/aws/lambda/app1",
        "/aws/lambda/app2",
        "/aws/rds/instance1",
        "/aws/rds/instance2",
        "/aws/ec2/security"
      ],
      "issues": [
        {
          "severity": "MEDIUM",
          "description": "CloudWatch Log Group /aws/lambda/app1 has no retention policy",
          "pci_reference": "10.5.1.2",
          "recommendation": "Set retention policy for log group /aws/lambda/app1"
        },
        {
          "severity": "MEDIUM",
          "description": "CloudWatch Log Group /aws/lambda/app2 has no retention policy",
          "pci_reference": "10.5.1.2",
          "recommendation": "Set retention policy for log group /aws/lambda/app2"
        },
        {
          "severity": "MEDIUM",
          "description": "CloudWatch Log Group /aws/rds/instance1 has no retention policy",
          "pci_reference": "10.5.1.2",
          "recommendation": "Set retention policy for log group /aws/rds/instance1"
        },
        {
          "severity": "MEDIUM",
          "description": "CloudWatch Log Group /aws/rds/instance2 has no retention policy",
          "pci_reference": "10.5.1.2",
          "recommendation": "Set retention policy for log group /aws/rds/instance2"
        },
        {
          "severity": "MEDIUM",
          "description": "CloudWatch Log Group /aws/ec2/security has no retention policy",
          "pci_reference": "10.5.1.2",
          "recommendation": "Set retention policy for log group /aws/ec2/security"
        }
      ]
    },
    "rds_logging": {
      "instances": 3,
      "instances_with_logging": 1,
      "instances_without_logging": [
        "db-instance-1",
        "db-instance-2"
      ],
      "issues": [
        {
          "severity": "MEDIUM",
          "description": "RDS instance db-instance-1 does not have CloudWatch logging enabled",
          "pci_reference": "10.2.1",
          "recommendation": "Enable CloudWatch logging for RDS instance db-instance-1"
        },
        {
          "severity": "MEDIUM",
          "description": "RDS instance db-instance-2 does not have CloudWatch logging enabled",
          "pci_reference": "10.2.1",
          "recommendation": "Enable CloudWatch logging for RDS instance db-instance-2"
        }
      ]
    },
    "iam_logging": {
      "credential_reports_enabled": false,
      "access_analyzer_enabled": false,
      "issues": [
        {
          "severity": "MEDIUM",
          "description": "IAM credential reports not enabled",
          "pci_reference": "10.2.1",
          "recommendation": "Enable IAM credential reports for access monitoring"
        },
        {
          "severity": "MEDIUM",
          "description": "IAM Access Analyzer not enabled",
          "pci_reference": "10.2.1",
          "recommendation": "Enable IAM Access Analyzer for policy analysis"
        }
      ]
    },
    "timestamp": "2025-06-18T20:41:03.684249",
    "total_issues": 12
  },
  "recommendations": [
    {
      "priority": "HIGH",
      "category": "CloudTrail",
      "title": "Enable CloudTrail",
      "description": "Enable CloudTrail for comprehensive API activity logging",
      "pci_reference": "10.2.1-10.2.7",
      "script": "setup_cloudtrail.sh",
      "estimated_cost": "Low (CloudTrail is free for first 5GB/month)"
    },
    {
      "priority": "MEDIUM",
      "category": "S3",
      "title": "Enable S3 Access Logging",
      "description": "Enable access logging for 3 S3 buckets",
      "pci_reference": "10.2.1",
      "script": "setup_s3_logging.sh",
      "estimated_cost": "Low (S3 access logs are inexpensive)"
    },
    {
      "priority": "MEDIUM",
      "category": "CloudWatch",
      "title": "Set Log Retention Policies",
      "description": "Set retention policies for 5 log groups",
      "pci_reference": "10.5.1.2",
      "script": "setup_cloudwatch_retention.sh",
      "estimated_cost": "Low (reduces storage costs)"
    },
    {
      "priority": "MEDIUM",
      "category": "RDS",
      "title": "Enable RDS CloudWatch Logging",
      "description": "Enable CloudWatch logging for 2 RDS instances",
      "pci_reference": "10.2.1",
      "script": "setup_rds_logging.sh",
      "estimated_cost": "Low"
    },
    {
      "priority": "MEDIUM",
      "category": "IAM",
      "title": "Enable IAM Monitoring",
      "description": "Configure IAM credential reports and access analyzer",
      "pci_reference": "10.2.1",
      "script": "setup_iam_monitoring.sh",
      "estimated_cost": "Free"
    },
    {
      "priority": "LOW",
      "category": "Monitoring",
      "title": "Set Up Monitoring Alerts",
      "description": "Configure CloudWatch alarms for security events",
      "pci_reference": "10.4.1",
      "script": "setup_monitoring_alerts.sh",
      "estimated_cost": "Low"
    },
    {
      "priority": "LOW",
      "category": "Cost",
      "title": "Implement Cost Optimization",
      "description": "Set up budgets and cost monitoring for log management",
      "pci_reference": "N/A",
      "script": "setup_cost_optimization.sh",
      "estimated_cost": "Free"
    }
  ],
  "pci_compliance": {
    "requirements": {
      "10.2.1": "All individual access to cardholder data",
      "10.2.2": "All actions taken by any individual with root or administrative privileges",
      "10.2.3": "Access to all audit trails",
      "10.2.4": "Invalid logical access attempts",
      "10.2.5": "Use of identification and authentication mechanisms",
      "10.2.6": "Initialization of the audit logs",
      "10.2.7": "Creation and deletion of system-level objects",
      "10.5.1.2": "Retain audit trail history for at least one year",
      "10.5.2": "Protect audit trail files from unauthorized modifications",
      "10.5.3": "Promptly back up audit trail files to a centralized log server"
    },
    "non_compliant_requirements": [
      "10.2.1-10.2.7",
      "10.2.1",
      "10.5.1.2"
    ]
  }
}